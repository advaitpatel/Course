================
Part II
================
1)
SELECT JOB, TO_CHAR(MAX(SALARY), '$99,990.00') AS "MAXIMUM SALARY", 
       TO_CHAR(AVG(SALARY + NVL(COMMISSION, 0)), '$99,990.00') AS "AVERAGE TOTAL PAY", 
       COUNT(EMPLOYEE_ID) AS "TOTAL NUMBER OF EMPLOYEES"
FROM EMPLOYEE
GROUP BY JOB
ORDER BY JOB;

2)
SELECT WORKER.EMPLOYEE_ID AS "EMPLOYEE ID", WORKER.EMPLOYEE_NAME AS "EMPLOYEE NAME", 
       WORKER.JOB AS "EMPLOYEE JOB", 
       NVL(TO_CHAR(WORKER.HIRE_DATE, 'DD-MON-YYYY'), '31-DEC-2999') AS "EMPLOYEE HIRE DATE", 
       NVL(MANAGER.EMPLOYEE_NAME, 'N/A') AS "MANAGER NAME",
       NVL(TO_CHAR(MANAGER.HIRE_DATE, 'DD-MON-YYYY'), '31-DEC-2999') AS "MANAGER HIRE DATE"
FROM EMPLOYEE WORKER
LEFT OUTER JOIN EMPLOYEE MANAGER
ON WORKER.MANAGER_ID = MANAGER.EMPLOYEE_ID
ORDER BY WORKER.EMPLOYEE_NAME;

3)
SELECT EMPLOYEE.DEPARTMENT_ID AS "DEPARTMENT ID", 
       DEPARTMENT.DEPARTMENT_NAME AS "DEPARTMENT NAME", 
       EMPLOYEE.EMPLOYEE_ID AS "EMPLOYEE ID",
       EMPLOYEE.EMPLOYEE_NAME AS "EMPLOYEE NAME", EMPLOYEE.JOB, 
       NVL(TO_CHAR(EMPLOYEE.HIRE_DATE, 'DD-MON-YYYY'), '') AS "HIRE DATE"       
FROM EMPLOYEE
INNER JOIN (SELECT DEPARTMENT_ID, MAX(HIRE_DATE) AS LAST_HIRE_DATE
              FROM EMPLOYEE
              GROUP BY DEPARTMENT_ID
              HAVING DEPARTMENT_ID IS NOT NULL
              ORDER BY DEPARTMENT_ID) G
ON EMPLOYEE.DEPARTMENT_ID = G.DEPARTMENT_ID
AND EMPLOYEE.HIRE_DATE = G.LAST_HIRE_DATE
INNER JOIN DEPARTMENT
ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID
ORDER BY DEPARTMENT.DEPARTMENT_NAME, EMPLOYEE.EMPLOYEE_NAME;

4)
SELECT B.DEPARTMENT_NAME AS "DEPARTMENT NAME", B.ADDRESS
FROM(SELECT DEPARTMENT_NAME, ADDRESS, COUNT(*) AS EMPLOYEE_COUNT
      FROM(SELECT E.DEPARTMENT_ID, D.DEPARTMENT_NAME, D.ADDRESS
            FROM EMPLOYEE E
            INNER JOIN DEPARTMENT D
            ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
            AND UPPER(D.ADDRESS) <> 'DALLAS' )
      GROUP BY DEPARTMENT_NAME, ADDRESS) B
INNER JOIN (SELECT ADDRESS, MAX(EMPLOYEE_COUNT) AS MAXCOUNT
            FROM(SELECT DEPARTMENT_ID, DEPARTMENT_NAME, ADDRESS, COUNT(*) AS EMPLOYEE_COUNT
                  FROM(SELECT E.DEPARTMENT_ID, D.DEPARTMENT_NAME, D.ADDRESS
                        FROM EMPLOYEE E
                        INNER JOIN DEPARTMENT D
                        ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
                        AND UPPER(D.ADDRESS) <> 'DALLAS' )
                  GROUP BY DEPARTMENT_ID, DEPARTMENT_NAME, ADDRESS) G
            GROUP BY ADDRESS) T
ON B.ADDRESS = T.ADDRESS AND B.EMPLOYEE_COUNT = T.MAXCOUNT;



